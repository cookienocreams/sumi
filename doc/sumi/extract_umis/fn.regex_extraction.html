<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Extract Unique Molecular Identifiers (UMIs) from a given sequence using regex."><title>regex_extraction in sumi::extract_umis - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-9bb858ba049f1f21.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="sumi" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.1 (d5c2e9c34 2023-09-13)" data-channel="1.72.1" data-search-js="search-f6292fe389d70017.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ><script src="../../static.files/storage-59fd9b8ccb335783.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../sumi/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../sumi/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><div class="sidebar-elems"><h2><a href="index.html">In sumi::extract_umis</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="../index.html">sumi</a>::<wbr><a href="index.html">extract_umis</a>::<wbr><a class="fn" href="#">regex_extraction</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/sumi/extract_umis.rs.html#154-241">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub fn regex_extraction(
    read_sequence: <a class="struct" href="https://doc.rust-lang.org/1.72.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>,
    record: Record,
    umi_delineator: &amp;<a class="primitive" href="https://doc.rust-lang.org/1.72.1/std/primitive.str.html">str</a>,
    writer: &amp;mut Writer&lt;<a class="struct" href="https://doc.rust-lang.org/1.72.1/std/fs/struct.File.html" title="struct std::fs::File">File</a>&gt;,
    umi_regex: &amp;Regex,
    is_qiagen: <a class="primitive" href="https://doc.rust-lang.org/1.72.1/std/primitive.bool.html">bool</a>,
    is_3p: <a class="primitive" href="https://doc.rust-lang.org/1.72.1/std/primitive.bool.html">bool</a>,
    start: <a class="primitive" href="https://doc.rust-lang.org/1.72.1/std/primitive.usize.html">usize</a>,
    adapter_mismatch: <a class="primitive" href="https://doc.rust-lang.org/1.72.1/std/primitive.bool.html">bool</a>
)</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Extract Unique Molecular Identifiers (UMIs) from a given sequence using regex.</p>
<p>The UMIs are searched using a regex
pattern related to known adapter sequences and can be located on either the 5’ or 3’ end. 
The function is able to process sequences from both gzipped and uncompressed FASTQ files.</p>
<h2 id="arguments"><a href="#arguments">Arguments</a></h2>
<ul>
<li><code>read_sequence</code> - The DNA sequence from the FASTQ record.</li>
<li><code>record</code> - The FASTQ record from which the UMI and other details are extracted.</li>
<li><code>umi_delineator</code> - Delimiter used between appended UMI and read name. The
default is “_” as is used in UMI-tools.</li>
<li><code>writer</code> - A mutable reference to the FASTQ writer for writing out the UMI-trimmed sequences.</li>
<li><code>umi_regex</code> - The regex pattern used to identify and capture the UMI in the <code>read_sequence</code>.</li>
<li><code>is_qiagen</code> - A flag indicating a specific trimming behavior.</li>
<li><code>is_3p</code> - A flag indicating whether the UMI is on the 3’ end of the sequence.</li>
<li><code>start</code> - The index where the regex first matches.</li>
<li><code>adapter_mismatch</code> - A flag indicating whether to allow mismatches and indels during alignment.</li>
</ul>
<h2 id="example"><a href="#example">Example</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span><span class="kw-2">mut </span>writer = Writer::new(File::create(<span class="macro">format!</span>(<span class="string">&quot;{}.processed.fastq&quot;</span>, <span class="string">&quot;sample_1&quot;</span>)).unwrap());
 
regex_extraction(<span class="string">&quot;GCATGCTACTGCTCGAT&quot;</span>, record, <span class="string">&quot;_&quot;</span>, <span class="kw-2">&amp;mut </span>writer, <span class="kw-2">&amp;</span><span class="string">&quot;(.{12}$)&quot;</span>, <span class="bool-val">false</span>, <span class="bool-val">true</span>, <span class="number">35</span>, <span class="bool-val">false</span>);
<span class="comment">// This will write to `writer` the UMI-trimmed sequences with UMI appended to the record&#39;s description.</span></code></pre></div>
<p>Note: The UMI is extracted using the provided <code>umi_regex</code>. This function is flexible to different 
UMI positions and patterns, unlike the previous version which expected UMIs to be the first 12 characters 
of the sequence.</p>
<p>It’s important to ensure that the regex pattern provided accurately captures the UMI without unintentionally 
capturing other portions of the sequence.</p>
</div></details></section></div></main></body></html>