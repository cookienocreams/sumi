<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Create a graph from a dictionary of UMIs and their counts."><title>umi_graph in sumi::graph - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-f3501f0f5ae15dfb.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="sumi" data-themes="" data-resource-suffix="" data-rustdoc-version="1.71.1 (eb26296b5 2023-08-03)" data-search-js="search-4926e5fc22a5646a.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-f0540c1d82cde29b.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../sumi/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../sumi/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><div class="sidebar-elems"><h2><a href="index.html">In sumi::graph</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="../index.html">sumi</a>::<wbr><a href="index.html">graph</a>::<wbr><a class="fn" href="#">umi_graph</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/sumi/graph.rs.html#99-172">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub fn umi_graph(
    umi_count_dict: &amp;<a class="struct" href="https://doc.rust-lang.org/1.71.1/std/collections/hash/map/struct.HashMap.html" title="struct std::collections::hash::map::HashMap">HashMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.71.1/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.71.1/std/primitive.u8.html">u8</a>&gt;, <a class="primitive" href="https://doc.rust-lang.org/1.71.1/std/primitive.u32.html">u32</a>&gt;,
    max_edits: <a class="primitive" href="https://doc.rust-lang.org/1.71.1/std/primitive.u32.html">u32</a>,
    use_levenshtein: <a class="primitive" href="https://doc.rust-lang.org/1.71.1/std/primitive.bool.html">bool</a>
) -&gt; (<a class="struct" href="https://docs.rs/petgraph/0.4/petgraph/graph_impl/struct.Graph.html" title="struct petgraph::graph_impl::Graph">Graph</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.71.1/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.71.1/std/primitive.u8.html">u8</a>&gt;, <a class="primitive" href="https://doc.rust-lang.org/1.71.1/std/primitive.u32.html">u32</a>&gt;, <a class="struct" href="https://doc.rust-lang.org/1.71.1/std/collections/hash/map/struct.HashMap.html" title="struct std::collections::hash::map::HashMap">HashMap</a>&lt;<a class="struct" href="https://docs.rs/petgraph/0.4/petgraph/graph_impl/struct.NodeIndex.html" title="struct petgraph::graph_impl::NodeIndex">NodeIndex</a>, (<a class="struct" href="https://doc.rust-lang.org/1.71.1/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.71.1/std/primitive.u8.html">u8</a>&gt;, <a class="primitive" href="https://doc.rust-lang.org/1.71.1/std/primitive.u32.html">u32</a>)&gt;)</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Create a graph from a dictionary of UMIs and their counts.</p>
<p>This function constructs a graph where each node represents a unique UMI and each edge represents
a edit distance less than or equal to <code>max_edits</code> between two UMIs. The edge creation is based 
on the condition that the count of one UMI should be at least five times the count of the other 
UMI minus 1. If the condition is met, an edge is added between the two UMIs. </p>
<p>The function implements a slightly modified directional graph algorithm that allows for a edit 
Distance of 1 between UMIs, see Fu, Y., et al, (2018). Elimination of PCR duplicates in RNA-seq 
and small RNA-seq using unique molecular identifiers. <a href="https://doi.org/10.1186/s12864-018-4933-1">https://doi.org/10.1186/s12864-018-4933-1</a>. 
The original algorithm uses a two fold count threshold. This version of the algorithm uses a 
substring indexing strategy to efficiently find potential neighbors for each UMI before computing 
the edit distance, hence improving the performance for large datasets.</p>
<p>Note that Levenshtein distance could be used here, but it generally takes longer to run and 
has a negligible effect on UMI deduplication.</p>
<h2 id="arguments"><a href="#arguments">Arguments</a></h2>
<ul>
<li><code>umi_count_dict</code> - A hashmap where the key is the UMI (as a byte array) and the value is its count.</li>
<li><code>max_edits</code> - The maximum edit distance allowed to consider two UMIs as neighbors 
(i.e., to add an edge between them).</li>
<li><code>use_levenshtein</code> - Whether to use the Levenshtein distance or the default Hamming distance
as the edit distance metric.</li>
</ul>
<h2 id="returns"><a href="#returns">Returns</a></h2>
<p>A tuple consisting of the UMI graph and a hashmap containing the node attributes. The graph is of 
type <code>Graph&lt;Vec&lt;u8&gt;, u32&gt;</code>, and the hashmap key is a <code>NodeIndex</code> which points to a tuple of UMI 
and its count.</p>
<h2 id="example"><a href="#example">Example</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>umi_count_dict: HashMap&lt;Vec&lt;u8&gt;, u32&gt; = HashMap::new();
<span class="comment">// populate umi_count_dict
</span><span class="kw">let </span>max_edits: u32 = <span class="number">1</span>;
<span class="kw">let </span>(graph, node_attributes) = umi_graph(<span class="kw-2">&amp;</span>umi_count_dict, max_edits);</code></pre></div>
</div></details></section></div></main></body></html>