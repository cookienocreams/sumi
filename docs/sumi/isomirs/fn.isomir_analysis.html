<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Analyze a given fastq file to count canonical miRNA and isomiR sequences."><title>isomir_analysis in sumi::isomirs - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-9bb858ba049f1f21.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="sumi" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.1 (d5c2e9c34 2023-09-13)" data-channel="1.72.1" data-search-js="search-f6292fe389d70017.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ><script src="../../static.files/storage-59fd9b8ccb335783.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../sumi/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../sumi/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><div class="sidebar-elems"><h2><a href="index.html">In sumi::isomirs</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="../index.html">sumi</a>::<wbr><a href="index.html">isomirs</a>::<wbr><a class="fn" href="#">isomir_analysis</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/sumi/isomirs.rs.html#363-485">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub fn isomir_analysis(
    fastq_file: &amp;<a class="struct" href="https://doc.rust-lang.org/1.72.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>,
    sample_name: &amp;<a class="struct" href="https://doc.rust-lang.org/1.72.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>,
    config: &amp;<a class="struct" href="../struct.Config.html" title="struct sumi::Config">Config</a>,
    mirna_hm: <a class="struct" href="https://doc.rust-lang.org/1.72.1/std/collections/hash/map/struct.HashMap.html" title="struct std::collections::hash::map::HashMap">HashMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.72.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>, <a class="struct" href="https://doc.rust-lang.org/1.72.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>&gt;,
    mirna_hm_mismatch: <a class="struct" href="https://doc.rust-lang.org/1.72.1/std/collections/hash/map/struct.HashMap.html" title="struct std::collections::hash::map::HashMap">HashMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.72.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>, <a class="struct" href="https://doc.rust-lang.org/1.72.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>&gt;,
    max_diffs: <a class="primitive" href="https://doc.rust-lang.org/1.72.1/std/primitive.usize.html">usize</a>
) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.72.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;(<a class="struct" href="https://doc.rust-lang.org/1.72.1/std/collections/hash/map/struct.HashMap.html" title="struct std::collections::hash::map::HashMap">HashMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.72.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>, <a class="primitive" href="https://doc.rust-lang.org/1.72.1/std/primitive.u64.html">u64</a>&gt;, <a class="struct" href="https://doc.rust-lang.org/1.72.1/std/collections/hash/map/struct.HashMap.html" title="struct std::collections::hash::map::HashMap">HashMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.72.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>, <a class="primitive" href="https://doc.rust-lang.org/1.72.1/std/primitive.u64.html">u64</a>&gt;), <a class="struct" href="https://doc.rust-lang.org/1.72.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/1.72.1/core/error/trait.Error.html" title="trait core::error::Error">Error</a>&gt;&gt;</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Analyze a given fastq file to count canonical miRNA and isomiR sequences.</p>
<p>This function first determines potential isomiRs of each canonical miRNA in the <code>mirna_hm</code> 
using the <code>create_isomirs</code> function. For each read in the fastq file, it determines if the
sequence is a canonical miRNA or an isomiR. For each detected sequence, it extracts the
UMI from the read name and, if the sequence is an isomiR, determines the corresponding
canonical miRNA and the specific modifications. The function then error-corrects the UMIs 
and counts deduplicated isomiRs based on these representative UMIs.</p>
<h2 id="returns"><a href="#returns">Returns</a></h2>
<ul>
<li>A <code>Result</code> wrapping a <code>HashMap</code> where the keys are isomiR names and the values are their deduplicated counts.
If an error occurred during processing, returns an <code>Err</code> with a description of the error.</li>
</ul>
<h2 id="arguments"><a href="#arguments">Arguments</a></h2>
<ul>
<li><code>fastq_file</code>: Path to the input fastq file.</li>
<li><code>sample_name</code>: Name of the sample being processed.</li>
<li><code>config</code>: Configuration settings, including the Levenshtein distance for UMI error correction.</li>
<li><code>mirna_hm</code>: A <code>HashMap</code> where the keys are canonical miRNA sequences and the values are their names.</li>
<li><code>max_diffs</code>: Maximum number of differences allowed when generating potential isomiRs.</li>
</ul>
<h2 id="notes"><a href="#notes">Notes</a></h2>
<p>UMIs are extracted from the read names using a regex (<code>READ_NAME_UMI_REGEX</code>).
The error correction of UMIs is done using the <code>find_true_isomir_umis</code> function.</p>
<h2 id="example"><a href="#example">Example</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>fastq_file = <span class="string">&quot;sample1.fastq&quot;</span>;
<span class="kw">let </span>config = Config {
    levenshtein_distance: <span class="number">2</span>,
    <span class="comment">// ... other fields ...
</span>};
<span class="kw">let </span>mirna_hm = get_canonical_mirnas();  <span class="comment">// Function to get canonical miRNAs
 
</span><span class="kw">let </span>deduplicated_counts = isomir_analysis(<span class="kw-2">&amp;</span>fastq_file, <span class="kw-2">&amp;</span><span class="string">&quot;sample1&quot;</span>.to_string(), <span class="kw-2">&amp;</span>config, mirna_hm, <span class="number">2</span>);
<span class="kw">match </span>deduplicated_counts {
    <span class="prelude-val">Ok</span>(counts) =&gt; <span class="macro">println!</span>(<span class="string">&quot;Successfully generated deduplicated counts for sample1: {:?}&quot;</span>, counts),
    <span class="prelude-val">Err</span>(e) =&gt; <span class="macro">eprintln!</span>(<span class="string">&quot;Error occurred: {}&quot;</span>, e),
}</code></pre></div>
</div></details></section></div></main></body></html>